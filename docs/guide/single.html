<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Release Plugin 1.0.0.M1</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#1 Introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#2 Configuration"><strong>2</strong><span>Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#3 Maven integration"><strong>3</strong><span>Maven integration</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                <span id="logo"><a href="http://grails.org" target="_blank"><img alt="Grails Logo" title="The Grails Framework" src="../img/grails.png" border="0"/></a></span>
                
                
                <span id="sponsor"><a href="http://springsource.com" target="_blank"><img alt="SpringSource Logo" title="SpringSource - Weapons for the War on Java Complexity" src="../img/springsource-logo.png" border="0"/></a></span>
                
            </div>
            <p>release-plugin</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>Release Plugin - Reference Documentation</h1>
                            <p><strong>Authors:</strong> Peter Ledbrook</p>
                            <p><strong>Version:</strong> 1.0.0.M1</p>
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#1 Introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.1 Migrating from release-plugin"><strong>1.1</strong><span>Migrating from release-plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#2 Configuration"><strong>2</strong><span>Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.1 Repositories"><strong>2.1</strong><span>Repositories</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.2 Plugin portals"><strong>2.2</strong><span>Plugin portals</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.3 Source control management"><strong>2.3</strong><span>Source control management</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#3 Maven integration"><strong>3</strong><span>Maven integration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.1 The local Maven cache"><strong>3.1</strong><span>The local Maven cache</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.2 Deployment to remote repositories"><strong>3.2</strong><span>Deployment to remote repositories</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        
<h1><a name="1 Introduction">1 Introduction</a></h1>
Many Grails projects are private applications and the only "publication" of those applications involves deploying the generated WAR file to a servlet container like Tomcat. But sometimes, particularly in the case of plugins, you want to share the project's WAR, zip or JAR. That's where the Release plugin comes in.<p class="paragraph"/>Once this plugin is installed, you can immediately start publishing your artifacts to Maven-compatible repositories. In the case of plugins, you can also publish them to Subversion-based repositories such as the Grails Central Plugin Repository. This user guide will show you exactly what you need to do.


<h2><a name="1.1 Migrating from release-plugin">1.1 Migrating from release-plugin</a></h2>
Starting with Grails 1.4, the Release plugin replaces the old <code>release-plugin</code> command. Fortunately, you should have little trouble switching to the new <code>publish-plugin</code> command. Let's take a look at the most important differences (apart from the name change!).<p class="paragraph"/><h4>No &#45;&#45;zipOnly option</h4><p class="paragraph"/>The new <code>publish-plugin</code> command has a more flexible approach to source control management than <code>release-plugin</code> and so the <code>&#45;&#45;zipOnly</code> option is no longer available. Instead, you specify whether you want the plugin to manage source control integration via the new <code>&#45;&#45;scm</code> and <code>&#45;&#45;noScm</code> options. The former is effectively the default, but you can disable SCM for the project via the <code>grails.release.scm.enabled</code> build configuration option.<p class="paragraph"/>The source control management is handled by plugins, such as the Subversion plugin that this plugin depends on. If you don't have the appropriate plugin for your SCM system, you won't be able to use the SCM integration.<p class="paragraph"/><h4>Configuration changes</h4><p class="paragraph"/>Although your old repository configurations will continue to work, i.e. ones like <code>grails.plugin.repos.distribution.&#60;id&#62;</code> used by <code>release-plugin</code>, there is far more flexibility if you migrate to the latest style of repository and portal configuration. In particular, by using the syntax described in chapter 2 you'll be able to put repository credentials and URLs in your personal ~/.grails/settings.groovy file.<p class="paragraph"/>You can also continue to use the repository configuration options supported by the old Maven Publisher plugin, but again, the new syntax is preferable.<p class="paragraph"/><h4>New metadata</h4><p class="paragraph"/>You can put extra metadata into your plugin descriptor, which will then be reflected both in the plugin's POM and in the Grails plugin portal. For example, you can specify:<p class="paragraph"/><div class="code"><pre>def license = <span class="java&#45;quote">"APACHE"</span>
def organization = &#91; name: <span class="java&#45;quote">"SpringSource"</span>, url: <span class="java&#45;quote">"http://www.springsource.org/"</span> &#93;
def developers = &#91;
        &#91; name: <span class="java&#45;quote">"Peter Ledbrook"</span>, email: <span class="java&#45;quote">"pledbrook@somewhere.net"</span> &#93;,
        &#91; name: <span class="java&#45;quote">"Graeme Rocher"</span>, email: <span class="java&#45;quote">"grocher@somewhere.net"</span> &#93; &#93;
def issueManagement = &#91; system: <span class="java&#45;quote">"JIRA"</span>, url: <span class="java&#45;quote">"http://jira.grails.org/browse/GRAILSPLUGINS"</span> &#93;
def scm = &#91; url: <span class="java&#45;quote">"http://svn.grails&#45;plugins.codehaus.org/browse/grails&#45;plugins/"</span> &#93;</pre></div><p class="paragraph"/>Note that the <code>developers</code> property should only include additional entries over and above the <code>author</code>. In other words, the primary author should still be declared in the <code>author</code> and <code>authorEmail</code> properties with only additional people going into the <code>developers</code> list.


<h1><a name="2 Configuration">2 Configuration</a></h1>
You can use the <code>publish-plugin</code> command to release plugins to the Grails Central Plugin Repository without any configuration whatsoever, but if you want to manage your own plugin repository and/or portal you will have to master the available configuration settings. The same goes if you want to deploy artifacts to a custom Maven-compatible repository. But don't worry: it's all very straightforward.<p class="paragraph"/>All the configuration options described in the next section can either go into your project's <code>BuildConfig.groovy</code> file or your personal <code>~/.grails/settings.groovy</code>. The latter is particular useful for storing credentials since the file is typically not stored in a shared source repository, thus making it easy to keep that information confidential.<p class="paragraph"/>Let's start by looking at how you can configure a Maven-compatible repository, since this is the most common scenario.


<h2><a name="2.1 Repositories">2.1 Repositories</a></h2>
With tools like <a href="http://nexus.sonatype.org/" target="blank">Nexus</a> and <a href="http://www.jfrog.com/products.php" target="blank">Artifactory</a>, it's pretty easy to set up a Maven-compatible repository these days. Fortunately, it's equally easy to publish Grails plugins and applications to such repositories.<p class="paragraph"/>Let's say you have a repository running on your local machine and you want to deploy a plugin to it. Your first step should be to assign the repository a unique ID, such as 'myRepo'. Next, you tell Grails where to find the repository by adding an entry to <code>BuildConfig.groovy</code> specifying its URL:<p class="paragraph"/><div class="code"><pre>grails.project.repos.myRepo.url = <span class="java&#45;quote">"http://localhost:8081/repos"</span></pre></div><p class="paragraph"/>The general form of the above configuration option is <code>grails.project.repos.&#60;repoId&#62;.url</code>.<p class="paragraph"/><blockquote class="note">
You can not use a repository ID of 'grailsCentral'. That is because it is reserved for the Grails Central Plugin Repository. The good news is that you can configure the username and password for 'grailsCentral' via the options described below.
</blockquote><p class="paragraph"/>You can now deploy artifacts to the repository by passing a <code>--repository=myRepo</code> argument to either the <a href="../ref/Command Line/publish-plugin.html" class="commandLine">publish-plugin</a> or <a href="../ref/Command Line/maven-deploy.html" class="commandLine">maven-deploy</a> commands.<p class="paragraph"/>Things become slightly more verbose if you want to provide extra details about the repository. What about user credentials for example? Here's a comprehensive configuration:<p class="paragraph"/><div class="code"><pre>grails.project.repos.myRepo.url = <span class="java&#45;quote">"http://localhost:8081/repos"</span>
grails.project.repos.myRepo.type = <span class="java&#45;quote">"maven"</span>
grails.project.repos.myRepo.username = <span class="java&#45;quote">"admin"</span>
grails.project.repos.myRepo.password = <span class="java&#45;quote">"password"</span>
grails.project.repos.myRepo.portal = <span class="java&#45;quote">"grailsCentral"</span></pre></div><p class="paragraph"/>As you can see, even a "full" explicit configuration is pretty short. So what do the various entries mean?
<ul class="star">
<li><code>url</code> - the URL to use when connecting to the remote repository. Typically this is HTTP-based, but "svn+ssh" is not uncommon for old-style Subversion plugin repositories.</li>
<li><code>type</code> - can be either "maven" or "svn", but the former is the default value so it's rare to explicitly declare a value of "maven" for this option.</li>
<li><code>username</code> - the username for connecting to the repository.</li>
<li><code>password</code> - the password for connecting to the repository.</li>
<li><code>portal</code> - the ID of the plugin portal to notify when publishing a plugin to this repository. Only affects the <code>publish-plugin</code> command.</li>
</ul><p class="paragraph"/>These settings are common to both Maven-compatible and Subversion repositories - it's only the values that typically differ between them. It's also worth bearing in mind that Subversion repositories can only be used for plugins.<p class="paragraph"/>The last option, <code>portal</code>, raises the question of how to declare plugin portals. What exactly is meant by a portal ID? The answer lies with portal configuration.


<h2><a name="2.2 Plugin portals">2.2 Plugin portals</a></h2>
When a Grails plugin is published to a repository, a plugin portal can optionally be notified of the release. For example, when you publish a plugin to the Grails Central Plugin Repository, the command will automatically notify the <a href="http://grails.org/plugins" target="blank">main plugin portal</a> on the grails.org website. That means people can see the details of the new release almost immediately.<p class="paragraph"/>Like repositories, portals have very few configuration options:<p class="paragraph"/><div class="code"><pre>grails.project.portal.&#60;portalId&#62;.url = <span class="java&#45;quote">"http://beta.grails.org/plugin/"</span> 
grails.project.portal.&#60;portalId&#62;.username = <span class="java&#45;quote">"joe"</span> 
grails.project.portal.&#60;portalId&#62;.password = <span class="java&#45;quote">"ht56jU&#38;B"</span></pre></div>
<ul class="star">
<li><code>url</code> - the URL of the plugin portal.</li>
<li><code>username</code> - the username to use when notifying the portal.</li>
<li><code>password</code> - the password to use.</li>
</ul><p class="paragraph"/>One thing to bear in mind: as with repositories, the ID 'grailsCentral' is reserved, this time for the <a href="http://grails.org/plugins/" target="blank">main plugin portal</a> on grails.org. Of course, you can still configure a username and password for this portal using the above settings.


<h2><a name="2.3 Source control management">2.3 Source control management</a></h2>
By default, source control management is enabled for the <code>publish-plugin</code> command. This means that the command ensures that the latest changes are committed and tagged before a plugin is published. If you don't want the command to do this, then you can disable it via the <code>&#45;&#45;noScm</code> command line option, but that gets tedious if you use it every time you run the command.<p class="paragraph"/>An alternative approach is to use a configuration setting to disable source control management for the project (or all projects if you put it into <code>~/.grails/settings.groovy</code>):<p class="paragraph"/><div class="code"><pre>grails.release.scm.enabled = <span class="java&#45;keyword">false</span></pre></div><p class="paragraph"/>Once the above setting is in place, <code>publish-plugin</code> will no longer attempt to commit and tag source changes. Of course, if you do this you lose the benefit of the plugin keeping the source and the published plugins reliably in sync.


<h1><a name="3 Maven integration">3 Maven integration</a></h1>
One of the best things that sprung from Maven was a standard way to provide Java dependencies to projects via HTTP-based repositories. Not only do we now have the Maven Central repository, but it's almost trivial to set up your own company-wide Maven-compatible repositories using tools like <a href="http://nexus.sonatype.org/" target="blank">Nexus</a> or <a href="http://www.jfrog.com/products.php" target="blank">Artifactory</a>. Following on from the Maven Publisher plugin, the Release plugin provides everything you need to easily and effectively deploy your project artifacts to such repositories.<p class="paragraph"/>Before we look at deployment to one of these remote repositories, let's look at another aspect of Maven: installing artifacts into the local Maven cache.


<h2><a name="3.1 The local Maven cache">3.1 The local Maven cache</a></h2>
When Maven builds a project, it first looks for the project's dependencies in the local Maven cache (by default <code>&#36;HOME/.m2/repository</code>). Only if a dependency is not in the cache does Maven pull it from the appropriate remote repository. This makes testing pretty easy: simply install your own version of the artifact into the Maven cache and that's the one that Maven will use. You don't have to deploy a development version of an artifact to a remote repository just to test it.<p class="paragraph"/>This approach doesn't only work for Maven. Grails can also pull artifacts from the Maven cache if you add the following entry to your project's <code>BuildConfig.groovy</code> file:<p class="paragraph"/><div class="code"><pre>grails.project.dependency.resolution = &#123;
    &#8230;
    repositories &#123;
        mavenLocal()
        &#8230;
    &#125;
    &#8230;
&#125;</pre></div><p class="paragraph"/>So how do you get your plugins or WAR files into the Maven cache? With the <a href="../ref/Command Line/maven-install.html" class="commandLine">maven-install</a> command:<p class="paragraph"/><pre class="bq"><code>
grails maven-install</code></pre><p class="paragraph"/>That's it! You can then test your new artifact locally. If you want, you can change where your artifacts are installed by adding the following configuration option to either <code>BuildConfig.groovy</code> or <code>settings.groovy</code>:<p class="paragraph"/><div class="code"><pre>grails.project.mavenCache = <span class="java&#45;quote">"target/m2cache"</span></pre></div><p class="paragraph"/>By adding this option to <code>settings.groovy</code> it will apply to every project that doesn't override it, so be careful!<p class="paragraph"/>Installing artifacts to the local Maven cache is trivial, so what about remote deployment?


<h2><a name="3.2 Deployment to remote repositories">3.2 Deployment to remote repositories</a></h2>
TBC See <a href="../ref/Command Line/maven-deploy.html" class="commandLine">maven-deploy</a> for the moment.


                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                        
                        <div class="menu-item"><a href="../ref/Command Line/generate-pom.html">generate-pom</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command Line/maven-deploy.html">maven-deploy</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command Line/maven-install.html">maven-install</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command Line/publish-plugin.html">publish-plugin</a>
                        </div>
                        
                        </div>
                    </div>
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
